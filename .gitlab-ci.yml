stages:
  - build
  - test
  - deploy
job1_build:
 image: microsoft/dotnet:latest
 stage: build
 script:
  - 'dotnet restore GelbooruChannelBot'
  - 'dotnet build GelbooruChannelBot'
 only:
   - dev
   - master

job1_deploy:
 image: docker:latest
 stage: deploy
 script:
  - 'docker stop gelbooruchannelbot || true && docker rm gelbooruchannelbot || true'
  - 'docker build -t gelbooruchannelbot .'
  - 'docker run --restart=always --name gelbooruchannelbot -d -e gelbooruchannelbot'
 only:
  - master
